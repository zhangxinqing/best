(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["colorui/components/wm-poster/wm-poster"],{"1a47":function(t,e,n){"use strict";n.r(e);var r=n("2661"),a=n("ca1f");for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var c=n("2877"),l=Object(c["a"])(a["default"],r["a"],r["b"],!1,null,null,null);e["default"]=l.exports},2661:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a})},ca1f:function(t,e,n){"use strict";n.r(e);var r=n("d5fa"),a=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,function(){return r[t]})}(i);e["default"]=a.a},d5fa:function(t,e,n){"use strict";(function(t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,i=c(n("a34a"));function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n,r,a,i,c){try{var l=t[i](c),u=l.value}catch(o){return void n(o)}l.done?e(u):Promise.resolve(u).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function c(t){l(i,r,a,c,u,"next",t)}function u(t){l(i,r,a,c,u,"throw",t)}c(void 0)})}}var o={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#e31d1a"},OriginalTxt:{Type:String,default:"199.99"},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:750},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"quitter推荐给你"},ViewDetails:{Type:String,default:"长按或扫描识别二维码"}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var e=u(i.default.mark(function e(){var n,r,c,l,u,o,s,f,x,p,d,g,T;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a.ctx=t.createCanvasContext(a.CanvasID,this),n=t.upx2px(a.Width),r=t.upx2px(30),c=t.upx2px(150),l=0,e.next=5,a.getImageInfo({imgSrc:a.imgSrc});case 5:return u=e.sent,e.next=8,a.getImageInfo({imgSrc:a.QrSrc});case 8:o=e.sent,s=[u.width,u.height],f=[o.width,o.height],x=n-2*r,s[0]!=x&&(s[1]=Math.floor(x/s[0]*s[1]),s[0]=x),f[0]!=c&&(f[1]=Math.floor(c/f[0]*f[1]),f[0]=c),a.canvasW=n,a.canvasH=s[1]+f[1]+128,a.ctx.setFillStyle(a.CanvasBg),a.ctx.fillRect(0,0,n,a.canvasH),a.ctx.drawImage(u.path,r,r,s[0],s[1]),a.ctx.setFontSize(t.upx2px(28)),a.ctx.setFillStyle(a.TitleColor),p=0,d=s[1]+2*r+10,g=1,T=0;case 25:if(!(T<a.Title.length)){e.next=47;break}if(l+=a.ctx.measureText(a.Title[T]).width,!(l>s[0])){e.next=43;break}if(2!=g||!a.LineType){e.next=36;break}return a.ctx.fillText(a.Title.substring(p,T-8)+"...",r,d),l=0,p=T,g++,e.abrupt("break",47);case 36:a.ctx.fillText(a.Title.substring(p,T),r,d),l=0,d+=20,p=T,g++;case 41:e.next=44;break;case 43:T==a.Title.length-1&&(a.ctx.fillText(a.Title.substring(p,T+1),r,d),l=0);case 44:T++,e.next=25;break;case 47:l=r,d+=t.upx2px(60),1==g&&(d+=20),""!=a.PriceTxt&&(a.ctx.setFillStyle(a.PriceColor),a.ctx.setFontSize(t.upx2px(38)),a.ctx.fillText(a.PriceTxt,l,d),l+=a.ctx.measureText(a.PriceTxt).width+t.upx2px(10)),""!=a.PriceTxt&&""!=a.OriginalTxt&&(a.ctx.setFillStyle(a.OriginalColor),a.ctx.setFontSize(t.upx2px(24)),a.ctx.fillText(a.OriginalTxt,l,d)),a.ctx.strokeStyle=a.OriginalColor,a.ctx.moveTo(l,d-t.upx2px(10)),a.ctx.lineTo(l+a.ctx.measureText(a.OriginalTxt).width,d-t.upx2px(10)),a.ctx.stroke(),d+=t.upx2px(20),a.ctx.drawImage(o.path,s[0]-f[0]+r,d,f[0],f[1]),a.ctx.setFillStyle(a.TitleColor),a.ctx.setFontSize(t.upx2px(30)),a.ctx.fillText(a.Referrer,r,d+f[1]/2),a.ctx.setFillStyle(a.OriginalColor),a.ctx.setFontSize(t.upx2px(24)),a.ctx.fillText(a.ViewDetails,r,d+f[1]/2+20),setTimeout(function(){a.ctx.draw(!0,function(t){a.getNewImage()})},600);case 65:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),getImageInfo:function(){var e=u(i.default.mark(function e(n){var r;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=n.imgSrc,e.abrupt("return",new Promise(function(e,n){t.getImageInfo({src:r,success:function(t){e(t)},fail:function(t){n(t)}})}));case 2:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),getNewImage:function(){t.canvasToTempFilePath({canvasId:a.CanvasID,quality:1,complete:function(t){console.log(r(t.tempFilePath," at colorui\\components\\wm-poster\\wm-poster.vue:214")),a.$emit("success",t)}},this)}},mounted:function(){a=this,a.OnCanvas()}};e.default=o}).call(this,n("6e42")["default"],n("0de9")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'colorui/components/wm-poster/wm-poster-create-component',
    {
        'colorui/components/wm-poster/wm-poster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("1a47"))
        })
    },
    [['colorui/components/wm-poster/wm-poster-create-component']]
]);                
